<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="./favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css">
    <title>Paper $PLANE Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script type="text/javascript" src="https://download.playfab.com/PlayFabClientApi.js"></script>
  <script type="module" crossorigin src="./assets/index-UNEvHXEX.js"></script>
  <link rel="modulepreload" crossorigin href="./assets/phaser-cxBNu8M8.js">
</head>

<body>
    <script>
        console.log('Webapp initialized');
        window.Telegram.WebApp.ready();

        var user = window.Telegram.WebApp.initDataUnsafe.user;
        var username = "Guest"
        if (user) {
            if (user.username && user.username.length > 0) {
                username = user.username;
            } else if (user.first_name && user.first_name.length > 0) {
                username = user.first_name;
            }
        }
        
        window.Telegram.WebApp.MainButton.setText('Join Paper $PLANE');
        window.Telegram.WebApp.MainButton.onClick(function () {
            window.Telegram.WebApp.openTelegramLink('https://t.me/paperplane_ton');
        });

        window.Telegram.WebApp.MainButton.enable();
        window.Telegram.WebApp.MainButton.show();
        
        if (username !== "Guest") {
            window.localStorage.setItem('username', username);

            PlayFab.settings.titleId = 'F6BAC';

            var LoginCallback = function (result, error) {
                if (result !== null) {
                    console.log(result);
                } else if (error !== null) {
                    console.log(PlayFab.GenerateErrorReport(error));
                }
            }
            
            var loginRequest = {
                TitleId: PlayFab.settings.titleId,
                CustomId: username,
                CreateAccount: true
            };

            PlayFabClientSDK.LoginWithCustomID(loginRequest, LoginCallback);

            alert('Welcome ' + username + ' to Paper $PLANE Game!');
        }
    </script>
    <div id="app">
        <div id="game-container"></div>
    </div>
    <img src="assets/loading.gif" alt="" id="loading" style="padding: 0; margin: 0; border-radius: 16px; overflow-clip-margin: 0; overflow: hidden; display: none; position: fixed; top: 36%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;" />
    <script>
        window.Telegram.WebApp.expand();
    </script>
</body>
</html>
